---
title: "Tarea 1"
output:
  html_document:
    df_print: paged
---

![](C:/Users\nicol\Escritorio\Pensamiento\Statistical_Thinking\T1\banner.png)

<center> <h1>Tarea 1: Foundations</h1> </center>
<center><strong>CC6104: Statistical Thinking</strong></center>
#### **Integrantes :** 

- Nicol치s Garc칤a R칤os

#### **Cuerpo Docente:**

- Profesor: Felipe Bravo M.
- Auxiliar: Sebastian Bustos e Ignacio Meza D.
            

#### **Fecha l칤mite de entrega:**

### **칈ndice:**

1. [Objetivo](#id1)
2. [Instrucciones](#id2)
3. [Referencias](#id3)
2. [Primera Parte: Preguntas Te칩ricas](#id4)
3. [Segunda Parte: Elaboraci칩n de C칩digo](#id5)

### **Objetivo**<a name="id1"></a>

Bienvenid@s a la primera tarea del curso Statistical Thinking. Esta tarea tiene como objetivo evaluar los contenidos te칩ricos de la primera parte del curso, los cuales se enfocan principalmente en an치lisis exploratorio de datos y conceptos introductorios de probabilidades. Si a칰n no han visto las clases, se recomienda visitar los enlaces de las referencias.

La tarea consta de una parte te칩rica que busca evaluar conceptos vistos en clases. Seguido por una parte pr치ctica con el f칤n de introducirlos a la programaci칩n en R enfocada en el an치lisis estad칤stico de datos. 

### **Instrucciones:**<a name="id2"></a>

- La tarea se realiza en grupos de **m치ximo 2 personas**. Pero no existe problema si usted desea hacerla de forma individual.
- La entrega es a trav칠s de u-cursos a m치s tardar el d칤a estipulado en la misma plataforma. A las tareas atrasadas se les descontar치 un punto por d칤a.
- El formato de entrega es este mismo **Rmarkdown** y un **html** con la tarea desarrollada. Por favor compruebe que todas las celdas han sido ejecutadas en el archivo html.
- Al momento de la revisi칩n tu c칩digo ser치 ejecutado. Por favor verifica que tu entrega no tenga errores de compilaci칩n.
- No ser치n revisadas tareas desarrolladas en Python.
- Est치 **PROHIBIDO** la copia o compartir las respuestas entre integrantes de diferentes grupos.
- Pueden realizar consultas de la tarea a trav칠s de U-cursos y/o del canal de Discord del curso. 


### **Referencias:**<a name="id3"></a>

Slides de las clases:

- [Introduction to Statistical Thinking](https://github.com/dccuchile/CC6104/blob/master/slides/1_1_ST-intro.pdf)
- [Introduction to R](https://github.com/dccuchile/CC6104/blob/master/slides/1_2_ST-R.pdf)
- [Descriptive Statistics](https://github.com/dccuchile/CC6104/blob/master/slides/1_3_ST-explore.pdf)
- [Probability](https://github.com/dccuchile/CC6104/blob/master/slides/1_4_ST-prob.pdf)

Videos de las clases:

- Introduction to Statistical Thinking: [video1](https://youtu.be/X4SqJu6lExM) [video2](https://youtu.be/YbiQU5TTBX4)
- Introduction to R: [video1](https://youtu.be/MbeLD3hWWVo) [video2](https://youtu.be/9W_eWCy86F4) [video3](https://youtu.be/QvFXSw2-1r4) [video4](https://youtu.be/y4JY7klrbfQ)
- Descriptive Statistics: [video1](https://youtu.be/kWNskZ8_98o) [video2](https://youtu.be/_FJ8x9M4b1w) [video3](https://youtu.be/m7VBNZ2mYWI) [video4](https://youtu.be/ylGMJ_aSQk0)
- Probability: [video1](https://youtu.be/R9AVYV73m1M) [video2](https://youtu.be/zubh1jbRiKE) [video3](https://youtu.be/uiwToagp0z4) [video4](https://youtu.be/RlhN3t_VIyw) [video5](https://youtu.be/4kV1dBaeWVc) [video6](https://youtu.be/MGyXc70JdSk)


# Primera Parte: Preguntas Te칩ricas<a name="id4"></a>
A continuaci칩n, se presentaran diferentes preguntas que abordan las tem치ticas vistas en clases. Por favor responda cada una de estas preguntas de forma breve, no m치s de 4 o 5 lineas.

#### **Pregunta 1:**
쯇or qu칠 la estad칤stica es importante?, 쯈ue nos permite realizar con los datos?. De alg칰n ejemplo.

> Porque la estad칤stica es una herramienta que trabaja el an치lisis e interpretaci칩n de datos, permitiendonos Describir, Decidir y Predecir el mundo que nos rodea.
>
> Un ejemplo visto en clase es el estudio de las grasas saturadas. Una idea com칰n es que comer muchas grasas saturadas, o incluso consumir un poco de ellas es muy perjudicial a la salud. Pero resulta que despu칠s de un estudio estad칤stico se pudo determinar que no solo no son malas, si no que hasta cierto punto estas son beneficiosas para la salud.
>
> De no ser por la estad칤stica, no podr칤amos haber descrito realmente la influencia de las grasas saturadas sobre la salud, y nos hubieramos basado en un pensamiento m치s Eur칤stico que Emp칤rico para la desicion de dietas, nutrici칩n, etc.

#### **Pregunta 2:**
Un amigue cercano a usted le comenta que le preocupa salir a la calle cuando hay ofertas en los helados, esto debido a que ha visto el siguiente titular en un famoso diario chileno: "El aumento en la compra de helados tiene una alta correlaci칩n con la muerte de personas en Santiago". 쯈ue le recomendar칤a a su amigue sobre el titular le칤do?, 쮻eber칤a preocuparse tanto?.

> Le recomendar칤a que deber칤a dejar de preocuparse, dado que el titular divulga probablemente informaci칩n falsa y sin un estudio estad칤stico exhastivo. 
>
>En la disciplina de la estad칤stica es muy dificil saber cuando tenemos causalidades directas entre variables, dado que varias relaciones ocultan otras realidades y relaciones ocultas, las cuales llamamos *variables de confusi칩n*. 
>
>Lo anterior lleva a que la **Correlaci칩n entre variables no implica Causalidad**, lo cu치l en palabras m치s simples y aplicado al ejemplo significa que *no porque aumente la cantidad de ofertas de helados significa que m치s gente va a morir*. No estamos considerando otras variables ocultas, como por ejemplo, probablemente todo lo anterior se debe al aumento de la temperatura en la ciudad de Santiago.

#### **Pregunta 3:**
Se침ale las diferentes aplicaciones que poseen las visualizaciones: Boxplot, histograma, gr치fico de pie y scatterplot.

> **Boxplot**: Nos permite visualizar la **distribuci칩n de datos num칠ricos**, pero a diferencia de los gr치ficos de funciones de densidad o probabilidad como la normal, este segmenta los datos en cuartiles y es capaz de mostrarlos utilizando una 칰nica dimensi칩n. La marca central indica la mediana, el rect치ngulo central indica donde se ubica el 25% de los datos menores y 25% de los datos mayores a la mediana, mientras que los *bigotes* indican los valores m치s externos. Este a su vez sirve para poder observar outliers o valores at칤picos dentro de los datos.
>
> **Histograma**: Nos permiten visualizar la **distribuci칩n completa** de los datos num칠ricos, ya sean discretos o continuos (utilizando rangos de valores). Al visualizar por completo la distribuci칩n de los datos por rangos, podemos tener una idea de la forma que toma la funci칩n de de densidad de probabilidad del dataset.
>
> **Gr치fico de Pie**: A diferencia de los gr치ficos anteriores, el Pie Chart sirve para **visualizar proporciones num칠ricas** de un conjunto de datos. Es 칰til cuando queremos visualizar distribuciones de variables categ칩ricas, pero no es viable para mostrar demasiados datos al dificultar su comprensi칩n.
>
> **Scatterplot**: Este gr치fico utiliza coordenadas cartesianas para graficar datos num칠ricos con dos o m치s variables. Es 칰til para apreciar el nivel de **dependencia y correlaci칩n entre dos variables num칠ricas** de un dataset, sean lineales o no lineales.


#### **Pregunta 4:**
Suponga que esta estudiando la diferencia en los sueldos de las personas que viven en Santiago y Rancagua. Suponiendo que los datos poseen outliers, 쯈ue m칠trica de resumen utilizar칤a para comparar los datos?. Justifique su respuesta.

> Utilizar칤a la **mediana**, ya que a diferencia del **promedio** esta es m치s robusta ante valores extremos en los datos, debido a que esta depende de la cantidad y densidad de los datos en vez de sus valores.

#### **Pregunta 5:**
En base al mismo dataset de sueldos para las regiones de Santiago y Rancagua, le comentan que existe un error en los datos y que estos deben ser modificados aumentando un 10% el valor original y sumando $15.000$ a cada uno de los datos. 쮺omo se ve afectada la media, mediana y desviaci칩n est치ndar con esta modificaci칩n?. Explique a trav칠s de ecuaciones el cambio que experimentan las m칠tricas de resumen respecto al valor original, considere para el caso de la media $\bar{X}_{old} = \dfrac{1}{m} \sum^{m}_{i=1} x_i$ y $sd_{old} = \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}(x_i-\bar{x})^{2}}$ para la desviaci칩n est치ndar.

> **Promedio:**
>
> $\bar{X}_{new} = \dfrac{1}{m} \sum^{m}_{i=1} 1.1x_i + 15000 = \dfrac{1.1}{m} \sum^{m}_{i=1} x_i + \dfrac{1}{m} \sum^{m}_{i=1} 15000$
>
> Donde la sumatoria de los x de al final corresponde justo al promedio anterior, teniendo que:
>
> $\bar{X}_{new} = 1.1 \bar{X}_{old} + 15000$
>
> Que es justamente la modificaci칩n realizada a cada dato por separado. Luego este cambi칩 linealmente respecto a la modificaci칩n.
>
> **Mediana:** Debido a que esta depende de la cantidad de datos y no de sus valores, esta variar치 de la misma forma en la que lo hace la mediana anterior. Luego la mediana tambi칠n cambia linealmente respecto a la modificaci칩n.
>
>
> **Desviaci칩n Est치ndar:**
>
> $sd_{new} = \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}((1.1x_i + 15000) - (1.1\bar{x} + 15000)^{2}} = \sqrt{\dfrac{1.1^{2}}{(m-1)}\sum_{i=1}^{m}(x_i - \bar{x})^{2}}$
> 
> Donde la sumatoria final corresponde justamente a la desviaci칩n estandar anterior pero por un factor 1.1, teniendo que:
>
> $sd_{new} = 1.1 sd_{old}$
>
> Que es el la pendiente de la modificiaci칩n realizada a los datos, Luego este aument칩 en un 10 porciento.

#### **Pregunta 6:**
Suponga que debe responder un examen sorpresa de 10 preguntas, con 5 alternativas por cada pregunta. 쮺ual es la probabilidad de obtener mas de 5 alternativas correctas si responde de forma aleatoria todo el examen?.

**Nota:** Puede resolver el ejercicio desarroll치ndolo a mano o utilizando c칩digo en R. 

``` {r eval=TRUE}
# Debido a que queremos calcular la probabilidad de un suceso dicot칩mico, es claro
# que tenemos una distribuci칩n Binomial:

# La probabilidad de responder cada pregunta correctamente es de un quinto:
p = 0.2
# Sabemos que son m치s de 5 preguntas de 10: 
x = c(6:10)
size = 10

# Luego la probabilidad solicitada es:
prob = 0
for(val in x){
  prob = prob + dbinom(val, size, p)
}

prob
```

#### **Pregunta 7:**
Supongamos que el 10% de los alumnos del curso utilizan Macintosh, el 60% utiliza Windows y el 30% utiliza Linux. Supongamos que el 50% de los usuarios de Mac, el 78% de los usuarios de Windows y el 20% de los usuarios de Linux han sucumbido bajo un terrible virus. Al seleccionar una persona al azar nos enteramos de que su sistema est치 infectado por el virus. 쮺u치l es la probabilidad de que sea un alumno con Windows?.

> Recopilemos las probabilidades conocidas:
>
> **SO:** M 10%, W 60%, 30$ L.
>
> **Virus:** M 50%, 78% W, 20% L.
>
> Sabiendo que la persona escogida si tiene un virus, debemos calcular la probabilidad de que el alumno tenga windows, esto es, calcular $\mathbb{P}( \text{Windows} | \text{Virus})$. Ahora por Teorema de Bayes, tenemos que $\mathbb{P}(X | Y) = \frac{\mathbb{P}(Y | X)*\mathbb{P}(X) }{\mathbb{P}(Y)}$, y definiendo $X$ como el evento de que alguien tenga Windows, e $Y$ como el evento de que alguien tenga el Virus, tendremos lo siguiente:
>
> $\mathbb{P}(\text{Windows} | \text{Virus}) = \frac{\mathbb{P}(\text{Virus} | \text{Windows}) * \mathbb{P}(\text{Windows})}{\mathbb{P}(\text{Virus})}$
>
> $\mathbb{P}(\text{Windows} | \text{Virus}) = \frac{0.78 * 0.6}{\mathbb{P}(\text{Virus})}$
>
> Ahora, usando que:
>
> $\mathbb{P}(X) = \sum^{n}_{i=1} \mathbb{P}(X, Y_{i}) = \sum^{n}_{i=1} \mathbb{P}(X | Y_{i}) * \mathbb{P}(Y_{i})$
>
> Podemos calcular $\mathbb{P}(\text{Virus}) = \sum^{n}_{i=1} \mathbb{P}(X | Y_{i}) * \mathbb{P}(Y_{i}) = 0.5*0.1 + 0.78*0.6 + 0.2*0.3 = 0.578$ 
>
> Finalmente $\mathbb{P}(\text{Windows} | \text{Virus}) = \frac{0.78 * 0.6}{0.578} \approx 0.81$


#### **Pregunta 8:**
Se침ale si las siguientes declaraciones son verdaderas o falsas respecto a las variables aleatorias:

- [ ] Como las variables aleatorias son funciones que nos permiten obtener valores de probabilidad, siempre podemos obtener $\mathbb{P}(X=x)>0$ evaluando en una $f(x)$ continua y discreta.
- [ ] Una PDF bien definida solo puede tener valores menores a 1 y un 치rea debajo de la curva igual a 1.
- [ ] La CDF puede ser representada como la integral de la PDF y PMF.
- [ ] Una CDF es definida para todo x, continua hacia la derecha y no es decreciente.

> Falso, dado que para una $f(x)$ continua $\mathbb{P}(X=x)$ siempre es 0, solo pueden evaluarse en rangos.
>
> Falso, ya que una PDF si puede tener valores iguales o mayores a 1.
>
> Falso, ya que en el caso de las PMF estamos con variables discretas, por lo que no es una funci칩n integrable. En vez de eso es necesaria una sumatoria.
>
> Verdadera.

#### **Pregunta 9:**
Una famosa fabrica de dulces se침ala que solo el $5\%$ de sus dulces contienen menos de $350$ gramos. Si los dulces elaborados por la fabrica distribuyen de forma normal, con media $\mu$ y desviaci칩n est치ndar $11.2$. Responda las siguientes preguntas:

- a) Encuentre la media del producto.
- b) Se침ale el porcentaje de dulces que se encuentran sobre los $390$ gramos.

**Nota:** Puede ser 칰til https://www.statskingdom.com/z_table.html

> Utilizando el enlace podemos determinar que $\mathbb{P}(X < -1.645) \approx 0.05$. Luego utilizando que $X = \mu + \sigma Z$ tenemos que:
>
> $350 = \mu - 1.645 \sigma$
>
> $\mu = 350 + 1.645*11.2 \approx 368.4$. Finalmente $\mu  \approx 368.4$ (a)
>
> Ahora debemos transformar de la distribuci칩n actual a la normal, lo cu치l se hace utilizando $Z = \frac{X - \mu}{\sigma}$. As칤 desarrollamos como sigue:
>
> $Z = \frac{390 - 368.4}{11.2} \approx 1.93$. Y viendo la tabla del enlace podemos determinar que $\mathbb{P}(X < 1.93) \approx 0.97 \Rightarrow \mathbb{P}(X > 1.93) \approx 1 - 0.97 = 3 \%$ (b)

---

# Segunda Parte: Elaboraci칩n de C칩digo<a name="id5"></a>

En la siguiente secci칩n deber치 resolver cada uno de los experimentos computacionales a trav칠s de la programaci칩n en R. Para esto se le aconseja que cree funciones en R, ya que le facilitar치 la ejecuci칩n de gran parte de lo solicitado.

### Pregunta 1: Visualizaci칩n de Datos

Para esta pregunta usted deber치 trabajar en base al conjunto de datos `hearth_database.csv`, el cual esta compuesto por las siguientes variables:

- target: Se침ala si el paciente tuvo un infarto.
- sex: Sexo de los sujetos de prueba.
- fbs: Az칰car en la sangre con ayunas. Esta variable se침ala solo si se encuentra <=120 o >120.
- exang: Angina de pecho inducida por el ejercicio.
- cp: Tipo de dolor de pecho.
- restecg: Resultados electrocardiogr치ficos en reposo.
- slope: Pendiente del segmento ST m치ximo de ejercicio.
- ca: N칰mero de buques principales.
- thal: Thalassemia.
- age: Edad en a침os.
- trestbps: Presi칩n arterial en reposo.
- chol: colesterol s칠rico en mg/dl.
- thalach: Frecuencia card칤aca m치xima alcanzada.
- oldpeak: Depresi칩n del ST inducida por el ejercicio en relaci칩n con el reposo.

En base al dataset propuesto realice un an치lisis exploratorio de los datos (EDA). Para su an치lisis enfoquen el desarrollo en las siguientes tareas:

- [ ] Obtenga la media, mediana, quintiles y valores m치ximos desde los datos que componen el dataset.
- [ ] Obtenga la Matriz de correlaci칩n de Pearson y visualice la relaci칩n entre las variables num칠ricas.
- [ ] Visualice los boxplot para las variables num칠ricas.
- [ ] Visualice a trav칠s de un histograma como distribuyen las variables respecto a los TARGET.

**Respuesta**

```{r eval=TRUE}
hdb <- read.csv("hearth_database.csv")
head(hdb)
```

Es importante chequear si es que existen valores nulos dentro del dataset antes de realizar la exploraci칩n sobre este. Para revisar la presencia de valores inexistentes se utilizar치 la funci칩n is.na(), que retorna un valor de verdad dependiendo si el dato es NA o no. Realizaremos la operaci칩n suma sobre estos valores booleanos, si la suma resultante es 0 quiere decir que no se encontraron valores en el dataset en que is.na() retornar치 TRUE, lo que nos indicar칤a que no hay datos inexistentes en las columnas.

```{r eval=TRUE}
sum(is.na(hdb))
```
La funci칩n ```summary``` aplica estad칤sticas a cada columna. En particular, indica el promedio, mediana, quantiles, m치ximo, m칤nimo, entre otros. Adem치s, cambiaremos el nombre de la columna age que ten칤a un error de tipado.

```{r eval=TRUE}

colnames(hdb)[10] <- "age"
summary(hdb)

```

Para conseguir los quintiles de cada uno de los datos num칠ricos, utilizaremos la funci칩n de R quantile (por algun motivo el for sobre 7 a 14 no retornaba los resultados, por lo que decid칤 ir uno por uno):
```{r eval=TRUE}
colnames(hdb)[7]
quantile(hdb[, 7], seq(0, 1, 0.2))

colnames(hdb)[8]
quantile(hdb[, 8], seq(0, 1, 0.2))

colnames(hdb)[9]
quantile(hdb[, 9], seq(0, 1, 0.2))

colnames(hdb)[10]
quantile(hdb[, 10], seq(0, 1, 0.2))

colnames(hdb)[11]
quantile(hdb[, 11], seq(0, 1, 0.2))

colnames(hdb)[12]
quantile(hdb[, 12], seq(0, 1, 0.2))

colnames(hdb)[13]
quantile(hdb[, 13], seq(0, 1, 0.2))

colnames(hdb)[14]
quantile(hdb[, 14], seq(0, 1, 0.2))

```

Ahora veremos la Matriz de Pearson para visualizar las correlaciones entre todas las variables num칠ricas:

```{r eval=TRUE}
library(ggplot2)

```



Boxplots

```{r eval=TRUE}
ggplot(data = hdb, aes(y = slope , x = target)) +
  geom_boxplot() 
ggplot(data = hdb, aes(y = ca , x = target)) +
  geom_boxplot() 
ggplot(data = hdb, aes(y = thal , x = target)) +
  geom_boxplot() 
ggplot(data = hdb, aes(y = age , x = target)) +
  geom_boxplot() 
ggplot(data = hdb, aes(y = trestbps , x = target)) +
  geom_boxplot() 
ggplot(data = hdb, aes(y = chol , x = target)) +
  geom_boxplot() 
ggplot(data = hdb, aes(y = thalach , x = target)) +
  geom_boxplot() 
ggplot(data = hdb, aes(y = oldpeak , x = target)) +
  geom_boxplot()

```





---

### Pregunta 2: Teorema Central del Limite

Pruebe el teorema central del limite aplicando un muestreo de la media en las distribuciones Poisson, Exponencial y una a su elecci칩n. Grafique los resultados obtenidos y se침ale aproximadamente el numero de muestreos necesarios para obtener el resultado esperado, pruebe esto con las siguientes cantidades de muestreo $\{10,100,1000,5000\}$. 쮼l efecto ocurre con el mismo n칰mero de muestreo para todas las distribuciones?.

**Respuesta**
Primero creamos nuestros vectores con datos de distribuci칩n aleatorios

```{r eval=TRUE}
# Elementos aleatorios con distribuci칩n de Poisson
poisson_1 <- rpois(10, lambda = 3)
poisson_2 <- rpois(100, lambda = 3)
poisson_3 <- rpois(1000, lambda = 3)
poisson_4 <- rpois(5000, lambda = 3)
  
# Elementos aleatorios con distribuci칩n Exponencial
exp_1 <- rexp(10, rate = 1)
exp_2 <- rexp(100, rate = 1)
exp_3 <- rexp(1000, rate = 1)
exp_4 <- rexp(5000, rate = 1)

# Elementos aleatorios con distribuci칩n Normal
norm_1 <- rnorm(10, 0, 1)
norm_2 <- rnorm(100, 0, 1)
norm_3 <- rnorm(1000, 0, 1)
norm_4 <- rnorm(5000, 0, 1)

```

Ya teniendo todos nuestros valores aleatorios, pasaremos a graficarlos en histogramas con sus densidades respectivas con el fin de observar que tanto se asimilan en su mediana y en la funci칩n de densidad te칩rica de cada distribuci칩n, seg칰n lo esperado en el Teorema Central del L칤mite

#### Poisson
Partiendo por la distribuci칩n de Poisson, el factor lamda ocupado para la generaci칩n de valores aleatorios corresponde justamente a su media.

```{r eval=TRUE}
# Primero creamos un dataframe de los datos aleatorios, con atributo 'vals'
pois1 <- data.frame(vals=poisson_1)
# Posteriormente creamos el plot que mostraremos en pantalla
p1<-ggplot(pois1, aes(x=vals)) + # Elegimos el dataframe a plotear
  geom_histogram(aes(y=..density..), colour="black", fill="white") + # Creamos el Histograma
  geom_density(alpha=.2, fill="#FF6666") + # Ploteamos la densidad del dataframe
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) + # Ploteamos la mediana del dataframe
  geom_vline(aes(xintercept=3),
            color="red", linetype="solid", size=1) +  # Ploteamos adem치s el lambda
  ggtitle("Poisson Distribution \n n = 10 , lambda = 3") +
  theme(plot.title = element_text(hjust = 0.5)) # Creamos el t칤tulo y su tema
p1  # Finalmente ploteamos toda la figura descrita anteriormente

pois2 <- data.frame(vals=poisson_2)
p2<-ggplot(pois2, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=3),
            color="red", linetype="solid", size=1) +
  ggtitle("Poisson Distribution \n n = 100 , lambda = 3") +
  theme(plot.title = element_text(hjust = 0.5))
p2

pois3 <- data.frame(vals=poisson_3)
p3<-ggplot(pois3, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=3),
            color="red", linetype="solid", size=1) +
  ggtitle("Poisson Distribution \n n = 1000 , lambda = 3") +
  theme(plot.title = element_text(hjust = 0.5))
p3

pois4 <- data.frame(vals=poisson_4)
p4<-ggplot(pois4, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=3),
            color="red", linetype="solid", size=1) +
  ggtitle("Poisson Distribution \n n = 5000 , lambda = 3") +
  theme(plot.title = element_text(hjust = 0.5))
p4
```

Notemos primero que a medida que aumentaba la cantidad de datos, la media muestral fu칠 acercandose cada vez m치s a la media te칩rica. Por otra parte, la forma oscilante de la densidad de los datos se deben a que estos son datos discretos y no continuos, pero sus cimas forman justamente una distribuci칩n de Poisson como tal.

Solo basta decir que este no toma muy claramente la distribuci칩n esperada por el Teorema Central del L칤mite hasta los 50000 datos, esto primero por las diferencias notables de la media te칩rica con la calculada hasta esta cantidad de datos, y por la forma de los datos con menor probabilidad.

#### Exponencial
Continuando con la distribuci칩n Exponencial, notemos que su media corresponde justamente al rate indicado en la generaci칩n de los datos aleatorios. As칤, podemos generar los siguientes gr치ficos:
```{r eval=TRUE}
exp1 <- data.frame(vals=exp_1)
e1<-ggplot(exp1, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=1),
            color="red", linetype="solid", size=1) +
  ggtitle("Exponential Distribution \n n = 10 , rate = 1") +
  theme(plot.title = element_text(hjust = 0.5))
e1

exp2 <- data.frame(vals=exp_2)
e2<-ggplot(exp2, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=1),
            color="red", linetype="solid", size=1) +
  ggtitle("Exponential Distribution \n n = 100 , rate = 1") +
  theme(plot.title = element_text(hjust = 0.5))
e2

exp3 <- data.frame(vals=exp_3)
e3<-ggplot(exp3, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=1),
            color="red", linetype="solid", size=1) +
  ggtitle("Exponential Distribution \n n = 1000 , rate = 1") +
  theme(plot.title = element_text(hjust = 0.5))
e3

exp4 <- data.frame(vals=exp_4)
e4<-ggplot(exp4, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=1),
            color="red", linetype="solid", size=1) +
  ggtitle("Exponential Distribution \n n = 5000 , rate = 1") +
  theme(plot.title = element_text(hjust = 0.5))
e4

```

Es clara la similitud de la funci칩n de densidad con 5000 datos y la distribuci칩n exponencial te칩rica. En este caso la media calculada y la te칩rica en el 칰ltimo gr치fico se sobreponen de forma perfecta, dejando en claro que ambas son pr치cticamente iguales.

Esta distribuci칩n, a diferencia de la de Poisson, ya obtiene similitudes con la distribuci칩n te칩rica a partir de los 1000 datos, por lo que podr칤amos decir que este necesita menor cantidad de datos para apreciar los resultados del Teorema Central del l칤mite.


#### Normal
Finalmente, la distribuci칩n escogida para el final fu칠 la bien conocida distribuci칩n Normal o Gaussiana, donde su media es 0 y su desviaci칩n 1:
```{r eval=TRUE}
norm1 <- data.frame(vals=norm_1)
n1<-ggplot(norm1, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=0),
            color="red", linetype="solid", size=1) +
  ggtitle("Normal Distribution \n n = 10 , mu = 0 , sigma = 1") +
  theme(plot.title = element_text(hjust = 0.5))
n1

norm2 <- data.frame(vals=norm_2)
n2<-ggplot(norm2, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=0),
            color="red", linetype="solid", size=1) +
  ggtitle("Normal Distribution \n n = 100 , mu = 0 , sigma = 1") +
  theme(plot.title = element_text(hjust = 0.5))
n2

norm3 <- data.frame(vals=norm_3)
n3<-ggplot(norm3, aes(x=vals)) +
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=0),
            color="red", linetype="solid", size=1) +
  ggtitle("Normal Distribution \n n = 1000 , mu = 0 , sigma = 1") +
  theme(plot.title = element_text(hjust = 0.5))
n3

norm4 <- data.frame(vals=norm_4)
n4<-ggplot(norm4, aes(x=vals)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") +
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=mean(vals)),
            color="blue", linetype="solid", size=1) +
  geom_vline(aes(xintercept=0),
            color="red", linetype="solid", size=1) +
  ggtitle("Normal Distribution \n n = 5000 , mu = 0 , sigma = 1") +
  theme(plot.title = element_text(hjust = 0.5))
n4
```

Al igual que la distribuci칩n Exponencial, esta ya presenta similitudes claras a partir de los mil datos, en especial con el valor de la media muestral y te칩rica.

Ya teniendo todos los gr치ficos anteriores, podr칤amos determinar que no todas las distribuciones necesitan la misma cantidad de datos para que las implicancias del Teorema Central del l칤mite se observen de forma clara. Un ejemplo es la distribuci칩n de Poisson, la cu치l hasta los 1000 datos podr칤amos haber confundido con la distribuci칩n exponencial. 

---

### Pregunta 3: Ley de los Grandes Numeros.

#### Lanzamiento de monedas
Realice el experimento de lanzar una moneda cargada 1000 veces y observe el comportamiento que tiene la probabilidad de salir cara. Para realizar el experimento considere que la moneda tiene una probabilidad de $4/5$ de salir cara. Grafique el experimento para las secuencias de intentos que van desde 1 a 1000, se침alando el valor en que converge la probabilidad de salir cara.

**Respuesta**

```{r eval=TRUE}

pcara = c(0)
caras = 0
for (lanzamientos in 1:1000) {
  coin <- sample(1:10, 1) # Tomaremos un numero al azar de 1 al 10
  if (coin < 9){
    caras <- caras + 1
  }
  prob = caras/lanzamientos
  pcara <- append(pcara, prob)
}

probs <- data.frame(probabilities = pcara)

# Gr치fico de la convergencia
graph <- ggplot(probs, aes(x=c(0:1000), y=probabilities)) + # graficamos el dataframe
  geom_line() +    # graficamos los datos en forma de l칤nea
  ylim(0, 1) +     # ponemos l칤mites a los ejes
  xlim(0, 1000) +  
  geom_hline(aes(yintercept=0.8),  
            color="red", linetype="solid", size=1, alpha = 0.4) + # Ponemos una l칤nea en 4/5
  xlab("Lanzamientos") +  
  ylab("Probabilidad") + 
  ggtitle("Probabilidad acumulada de salir cara") + 
  theme(plot.title = element_text(hjust = 0.5))
graph
```

#### El problema de Monty Hall 

Remont치ndonos en la televisi칩n del a침o 1963, en USA exist칤a un programa de concursos donde los participantes deb칤an escoger entre 3 puertas para ganar un premio so침ado. El problema del concurso era que solo detr치s de 1 puerta estaba el premio mayor, mientras que detr치s de las otras dos hab칤an cabras como "premio". 

Una de las particularidades de este concurso, es que cuando el participante escog칤a una puerta, el animador del show abr칤a una de las puertas que no fue escogida por el participante (Obviamente la puerta abierta por el animador no conten칤a el premio). Tras abrir la puerta, el animador consultaba al participante si su elecci칩n era definitiva, o si deseaba cambiar la puerta escogida por la otra puerta cerrada.

Imagine que usted es participante del concurso y desea calcular la probabilidad de ganar el gran premio **si cambia de puerta** en el momento que el animador se lo ofrece. Utilizando listas/arrays/vectores simule las puertas del concurso, dejando aleatoriamente el premio en alguna posici칩n del array. Hecho esto, genere un numero de forma aleatoria para escoger una de las puerta (posiciones de la estructura), para luego ver si cambiando de posici칩n tendr치 mayores posibilidades de ganar el premio. Genere N veces el experimento y grafique cada una de las iteraciones, tal como se hizo en el ejercicio de las monedas.

<p align="center">
  <img src="https://brilliant-staff-media.s3-us-west-2.amazonaws.com/tiffany-wang/gWotbuEdYC.png" width="350">
</p>


**Respuesta:**

```{r eval=TRUE}
# Creamos una funci칩n que simule el juego
montyhall <- function(cambiar = TRUE){
  Puertas <- sample(1:3,3)             # Puertas donde la posici칩n que tiene el 3 es el premio
  posicion <- sample(1:3,1)            # Elecci칩n del participante.
  
  if (cambiar){ 
    if (Puertas[posicion] == 3){
      Eleccion <- 0 
    } else {
      Eleccion <- 1
    }
  } else {
    if (Puertas[posicion] == 3){
      Eleccion <- 1
    } else {
      Eleccion <- 0
    }
  }
  
  return(Eleccion) # Retornamos la elecci칩n, esta puede que tenga el premio o no
}

# Funci칩n que simula N juegos
n_juegos <- function(n = 10 ,cambiar_puerta = TRUE){
  probs <- c(0)
  wins <- 0
  for (i in c(1:n)){
    eleccion <- montyhall(cambiar_puerta)
    if (eleccion == 1){
      wins <- wins + 1
    }
    prob = wins/i
    probs <- append(probs, prob)
  }
  return(probs) # Vector de largo n + 1 
}
```

Una primera impresi칩n es que la probabilidad de 칠xito despu칠s de cambiar la primera puerta escogida sigue siendo la misma que no cambiarla, pero este razonamiento es erroneo. La probabilidad de 칠xito eligiendo solo una puerta es claramente de 1/3 y esta sigue manteniendose si en la segunda instancia se decide no cambiar la puerta, pero la probabilidad de 칠xito al cambiar de puerta en la segunda instancia es de 2/3, debido a que la probabilidad de que la primera puerta escogida sea el premio mayor es de 1/3 lo que implica que la probabilidad de que la segunda puerta tenga el premio mayor es de 1 - 1/3 = 2/3.

Con lo anterior, graficaremos la probabilidad acumulada por cada iteraci칩n del juego y adem치s la constante 2/3 para observar c칩mo esta converge a este valor en vez de 1/3.

```{r eval=TRUE}
n <- 100
Probs <- data.frame(probabilities = n_juegos(n, TRUE)) # tiene n + 1 elementos
# Gr치fico de la convergencia
graph <- ggplot(Probs, aes(x=c(0:n), y=probabilities)) + # graficamos el dataframe
  geom_line() +    # graficamos los datos en forma de l칤nea
  ylim(0, 1) +     # ponemos l칤mites a los ejes
  xlim(0, n) +  
  geom_hline(aes(yintercept=2/3),  
            color="red", linetype="solid", size=1, alpha = 0.4) +
  xlab("N칰mero de Juego") +  
  ylab("Probabilidad") + 
  ggtitle("Probabilidad acumulada de ganar al cambiar puerta en Monty Hall") + 
  theme(plot.title = element_text(hjust = 0.5))
graph

```

---

### Pregunta 4: 쯀ndependencia?
Ustedes disponen de los dados D1 y D2, los cuales no est치n cargados y son utilizados para comprobar que $\mathbb{P}(AB)=\mathbb{P}(A)\mathbb{P}(B)$ cuando el evento A es independiente del B. Para estudiar la independencia considere que los eventos A y B se definen de la siguiente manera; sea A el evento dado por los valores obtenidos en el lanzamiento del dado D1, este est치 compuesto por $A=\{D1=1,D1=2,D1=6\}$. Por otro lado, el evento B viene dado por los valores obtenidos con el dado D2, el que est치 conformado por $B=\{D2=1,D2=2,D2=3,D2=4\}$. Con esto, tendremos un $\mathbb{P}(A)=1/2$, $\mathbb{P}(洧냣)=2/3$ y $\mathbb{P}(AB)=1/3$. Compruebe de forma gr치fica que al realizar 1000 lanzamientos (u otro valor grande que usted desea probar) se visualiza que $\mathbb{P}(AB)=\mathbb{P}(A)\mathbb{P}(B)$. 

Hecho lo anterior, compruebe el comportamiento de un segundo grupo de eventos, dados por el lanzamiento de solo el dado D1. Donde, los eventos para D1 quedan definidos como: $A =\{D1=1,D1=2,D1=6\}$ y $B=\{D1=1,D1=2,D1=3\}$. 쯉e observa independencia en este experimento?.

Se le aconseja que para simular los lanzamientos de dados utilice la funci칩n `sample()` para generar valores aleatorios entre 1 y 6. Compruebe los n칰meros generados por la funci칩n con los casos favorables de cada uno de los eventos a ser estudiados.

**Respuesta:**

```{r eval=FALSE}
# Primer grupo de eventos
N_lan = 1000 # Numero de lanzamientos
  
L_A =  # Lanzamientos favorables A = c(1, 2, 6)
L_B =  # Lanzamientos favorables B = c(1, 2, 3, 4)
L_AB = # Lanzamientos favorables AB = c(1, 2)
```

```{r eval=FALSE}
# Segundo grupo de eventos
N_lan = 1000 # Numero de lanzamientos
  
L_A =  # Lanzamientos favorables A = c(1, 2, 6)
L_B =  # Lanzamientos favorables B = c(1, 2, 3)
L_AB = # Lanzamientos favorables AB = c(1, 2)
```

---

### Pregunta 5: La Ruina del Jugador
Un amigo lud칩pata suyo le comenta que el truco de jugar en el casino esta en no parar de apostar y apostando lo m칤nimo posible. Ya que as칤, tienes mas probabilidades de ganar el gran pozo que acumula el juego. Usted sabiendo la condici칩n de su amigo, decide no creer en su conjetura y decide probar esto a trav칠s de un experimento.

Para realizar el experimento usted decide asumir las siguientes declaraciones, bajo sus observaciones:

- La probabilidad de ganar en un juego del casino es $9/19$
- Sabe que su amigo posee fondos en el rango de 0 a 200 dolares.
- Las apuestas como m칤nimo deben ser igual a 5 dolares.
- El monto de las apuestas no cambia y son siempre igual a la primera. Por ejemplo, si su amigo apuesta 50 dolares, todos los pr칩ximos juegos apuesta 50 hasta que se acaba su dinero.

En el experimento deber치 obtener la evoluci칩n de los fondos hasta que el jugador se queda sin fondos para jugar. Puede ser 칰til seguir la l칩gica de una moneda cargada para realizar esto. Pruebe esto con una apuesta igual a 5, 25 y 50 graficando los resultados. Comente los resultados obtenidos.

**Respuesta**

```{r eval=TRUE}
# Funci칩n para obtener el desarrollo de las apuestas
ruina <- function(fondos = 100, apuesta = 5){
  vec_fondos <- c(fondos)
  while (0<fondos & fondos<200) {
    bet <- sample(1:19, 1) # Tomaremos un numero al azar de 1 al 19
    if (bet < 10){
      fondos <- fondos + apuesta
    } else{
      fondos <- fondos - apuesta
    }
    vec_fondos <- append(vec_fondos, fondos)
  }
  return(vec_fondos) # Devuelve un vector con el desarrollo de los fondos
}

plot(ruina(), type="l", col="blue", xlab="N춿 de juegos", ylab="Fondos", main="Evoluci칩n de los fondos (apuesta = 5)")
plot(ruina(apuesta = 25), type="l", col="blue", xlab="N춿 de juegos", ylab="Fondos", main="Evoluci칩n de los fondos (apuesta = 25)")
plot(ruina(apuesta = 50), type="l", col="blue", xlab="N춿 de juegos", ylab="Fondos", main="Evoluci칩n de los fondos (apuesta = 50)")
```

Con lo anterior podemos notar que claramente nuestra conjetura es correcta, y que nuestro compa침ero est치 equivocado. Realizar siempre la misma apuesta con un valor bajo da la ilusi칩n de ganar m치s, debido a que esta puede extenderse por m치s tiempo que con apuestas de mayor valor, adem치s de que se necesita mayor cantidad de aciertos para poder llegar a los l칤mites del fondo.

Por otro lado, con las apuestas de mayor valor se reducen r치pidamente la cantidad de apuestas realizadas, debido a que pueden sobrepasar los l칤mites del fondo m치s r치pidamente respecto a las apuestas de menor valor. Por lo anterior podemos inferir que realizar apuestas de valores m치s altos tienen mayor probabilidad de generar muchas m치s ganancias por secuencias de victorias consecutivas, pero equivalentemente puede llevar a la quiebra m치s facilmente.


&nbsp;
<hr />
<p style="text-align: center;">A work by <a href="https://github.com/dccuchile/CC6104">CC6104</a></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/dccuchile/CC6104"><i class="fab fa-github" style='font-size:30px'></i></a>
</p>

&nbsp;